---
- name: "{{item.name}}: Start Firecracker console"
  systemd:
    state: started
    name: "firecracker-console@{{item.name}}"
    scope: user

- name: "{{item.name}}: Start Firecracker service"
  systemd:
    state: started
    name: "firecracker@{{item.name}}"
    scope: user

- name: "{{item.name}}: Configuring Boot Source"
  uri:
    url: http://localhost/boot-source
    method: PUT
    unix_socket: "{{firecracker_runpath}}/firecracker-{{item.name}}.socket"
    body: "{{item.boot_source|to_json}}"
    status_code:
      - 200
      - 204
    body_format: json